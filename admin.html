<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<title>App 管理后台</title>
<link rel="icon" href="https://wangwenzhi.eu.org/images/favicon_io/favicon-32x32.png">
<style>
    body { font-family: 'SF Pro Display', -apple-system, sans-serif; margin: 0; background: #fafafa; color: #1d1d1f; }
    header { position: sticky; top: 0; background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(10px); padding: 10px 20px;
             box-shadow: 0 2px 10px rgba(0,0,0,0.05); z-index: 10; display: flex; align-items: center; justify-content: space-between; }
    .logo { width: 30px; height: 30px; cursor: pointer; }
    .logo img { width: 100%; height: 100%; object-fit: contain; transition: transform 0.3s; }
    .logo:hover img { transform: scale(1.1); }
    h1 { font-size: 20px; font-weight: 600; margin: 0; flex: 1; text-align: center; }
    .back-home { background: none; border: none; font-size: 14px; color: #000; cursor: pointer; }
    #categories { max-width: 1000px; margin: 20px auto; padding: 0 20px; }
    .category { background: #fff; border-radius: 18px; padding: 15px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); margin-bottom: 20px; }
    .category h2 { font-size: 18px; margin-bottom: 10px; display: flex; align-items: center; gap: 8px; }
    .category input[type="text"] { flex: 1; padding: 6px 8px; border-radius: 6px; border: 1px solid #ccc; font-size: 14px; }
    .app { display: grid; grid-template-columns: repeat(4, 1fr) auto; gap: 5px; margin-bottom: 5px; }
    .app input { padding: 6px 8px; border-radius: 6px; border: 1px solid #ccc; font-size: 12px; }
    button { cursor: pointer; border: none; border-radius: 8px; padding: 6px 10px; font-size: 12px; }
    .add-btn { background: #000; color: white; }
    .delete-btn { background: #dc3545; color: white; }
    .floating-btn { position: fixed; left: 30px; width: 50px; height: 50px; border-radius: 50%;
        display: flex; align-items: center; justify-content: center; font-size: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        z-index: 999; background: #fff; color: #000; border: 1px solid #ccc; }
    #downloadBtn { bottom: 100px; }
    #uploadBtn { bottom: 30px; }
    @media (prefers-color-scheme: dark) {
        body { background: #1c1c1e; color: #f5f5f7; }
        header { background: rgba(28, 28, 30, 0.9); box-shadow: 0 2px 10px rgba(0,0,0,0.3); }
        .category { background: #2c2c2e; box-shadow: 0 4px 12px rgba(0,0,0,0.2); }
        .category input, .app input { background: #3a3a3c; color: #fff; border: 1px solid #555; }
        .back-home { color: #f5f5f7; }
        .floating-btn { background: #000; color: #fff; border: 1px solid #555; }
    }
</style>
</head>
<body>
<header>
    <a href="index.html" class="logo" title="返回首页">
        <img src="https://wangwenzhi.eu.org/images/favicon_io/apple-touch-icon.png" alt="Logo" loading="lazy">
    </a>
    <h1>App 管理后台</h1>
    <button class="back-home" onclick="window.location.href='index.html'">返回主页</button>
</header>
<div id="categories"></div>
<button id="downloadBtn" class="floating-btn" title="下载 apps.js">💾</button>
<button id="uploadBtn" class="floating-btn" title="上传到 GitHub">⬆️</button>
<script src="apps.js"></script>
<script>
(function(){
    const container = document.getElementById('categories');
    function render() {
        container.innerHTML = '';
        appData.forEach((cat, ci) => {
            const catDiv = document.createElement('div');
            catDiv.className = 'category';
            catDiv.innerHTML = `
                <h2>
                    <input type="text" value="${cat.title}" onchange="appData[${ci}].title=this.value">
                    <button class="delete-btn" onclick="deleteCategory(${ci})">删除分类</button>
                </h2>
                <div>
                    ${cat.apps.map((app, ai) => `
                        <div class="app">
                            <input value="${app.name}" placeholder="名称" onchange="appData[${ci}].apps[${ai}].name=this.value">
                            <input value="${app.description}" placeholder="描述" onchange="appData[${ci}].apps[${ai}].description=this.value">
                            <input value="${app.link}" placeholder="链接" onchange="appData[${ci}].apps[${ai}].link=this.value">
                            <input value="${app.icon}" placeholder="图标" onchange="appData[${ci}].apps[${ai}].icon=this.value">
                            <button class="delete-btn" onclick="deleteApp(${ci},${ai})">🗑</button>
                        </div>
                    `).join('')}
                </div>
                <button class="add-btn" onclick="addApp(${ci})">➕ 添加应用</button>
            `;
            container.appendChild(catDiv);
        });
    }
    window.addApp = function(ci) { appData[ci].apps.push({ name:"", description:"", link:"", icon:"" }); render(); }
    window.deleteApp = function(ci, ai) { if(confirm("确定删除这个应用吗？")){ appData[ci].apps.splice(ai,1); render(); } }
    window.deleteCategory = function(ci) { if(confirm("确定删除这个分类吗？")){ appData.splice(ci,1); render(); } }
    document.getElementById('downloadBtn').onclick = function(){
        const blob = new Blob([`const appData = ${JSON.stringify(appData, null, 4)};`], {type: "application/javascript"});
        const a = document.createElement('a');
        a.href = URL.createObjectURL(blob);
        a.download = "apps.js";
        a.click();
    }
    document.getElementById('uploadBtn').onclick = function(){
        window.location.href = "https://github.com/wangwenzhiwwz/File/upload/master";
    }
    render();
})();
</script>
</body>
</html>